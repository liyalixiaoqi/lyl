var O=Object.defineProperty,$=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var F=(d,u,t)=>u in d?O(d,u,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[u]=t,L=(d,u)=>{for(var t in u||(u={}))W.call(u,t)&&F(d,t,u[t]);if(D)for(var t of D(u))Y.call(u,t)&&F(d,t,u[t]);return d},T=(d,u)=>$(d,M(u));var B=(d,u,t)=>new Promise((o,_)=>{var r=i=>{try{c(t.next(i))}catch(b){_(b)}},N=i=>{try{c(t.throw(i))}catch(b){_(b)}},c=i=>i.done?o(i.value):Promise.resolve(i.value).then(r,N);c((t=t.apply(d,u)).next())});import{e as q,f as H,v as J,g as K,h as P,i as Q,j as X,k as Z,w as h,x as ee}from"./element-plus-08231d.js";import{g as le,a as ae}from"./shared/index-6/index-7-47dc25.js";import{v as te,r as x,a2 as S,F as oe,G as ne,x as f,y as g,W as a,U as n,R as I,aG as E,ai as k,T as U,Y as ue,aR as se}from"./vendor-2eaabd.js";import"./common-4c9815.js";const re=te({__name:"index",setup(d){const u=x([]),t=x([]),o=S({userName:"",nickname:"",roleId:[]}),_=x(!1),r=S({id:"",userName:"",nickname:"",role:[]});oe(()=>{c(),N()});const N=()=>B(this,null,function*(){const s=yield le();u.value=s}),c=()=>{ae().then(s=>{t.value=s})},i=()=>{let s=[];o.userName||o.nickname||o.roleId?s=t.value.filter(e=>!(o.userName&&!e.userName.includes(o.userName)||o.nickname&&!e.nickname.includes(o.nickname)||o.roleId&&!e.role.some(m=>m.id===o.roleId))):s=t.value,t.value=s};ne([()=>o.userName,()=>o.nickname,()=>o.roleId],()=>{c()});const b=s=>{_.value=!0,Object.assign(r,T(L({},s),{roleId:s.role.map(e=>e.id)||[]}))},j=()=>{let s=t.value.find(e=>e.id===r.id);s&&(s.userName=r.userName,s.nickname=r.nickname,s.role=r.roleId.map(e=>{var m;return{id:e,userRole:((m=u.value.find(p=>p.id===e))==null?void 0:m.userRole)||""}})),_.value=!1};return(s,e)=>{const m=q,p=H,w=h,C=J,V=K,R=P,v=Q,z=ee,A=X,G=Z;return f(),g("div",null,[a(R,{model:o,inline:!0,style:{"margin-right":"20px"}},{default:n(()=>[a(p,{label:"用户名"},{default:n(()=>[a(m,{modelValue:o.userName,"onUpdate:modelValue":e[0]||(e[0]=l=>o.userName=l)},null,8,["modelValue"])]),_:1}),a(p,{label:"昵称"},{default:n(()=>[a(m,{modelValue:o.nickname,"onUpdate:modelValue":e[1]||(e[1]=l=>o.nickname=l)},null,8,["modelValue"])]),_:1}),a(p,{label:"角色",style:{width:"180px"}},{default:n(()=>[a(C,{modelValue:o.roleId,"onUpdate:modelValue":e[2]||(e[2]=l=>o.roleId=l),placeholder:"请选择角色",clearable:""},{default:n(()=>[(f(!0),g(I,null,E(u.value,l=>(f(),U(w,{key:l.id,label:l.userRole,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:n(()=>[a(V,{type:"primary",onClick:i},{default:n(()=>e[8]||(e[8]=[k("搜索")])),_:1,__:[8]})]),_:1})]),_:1},8,["model"]),a(A,{data:t.value,style:{width:"100%"}},{default:n(()=>[a(v,{prop:"id",label:"ID"}),a(v,{prop:"userName",label:"用户名"}),a(v,{prop:"nickname",label:"昵称"}),a(v,{prop:"role",label:"角色"},{default:n(l=>[(f(!0),g(I,null,E(l.row.role,y=>(f(),U(z,{key:y.id,type:y.userRole==="管理员"?"success":"info",class:"tag-role",size:"small"},{default:n(()=>[k(ue(y.userRole),1)]),_:2},1032,["type"]))),128))]),_:1}),a(v,{label:"操作"},{default:n(l=>[a(V,{type:"primary",size:"small",onClick:y=>b(l.row)},{default:n(()=>e[9]||(e[9]=[k("编辑")])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(G,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=l=>_.value=l),title:"编辑用户",width:"500px"},{footer:n(()=>[a(V,{onClick:e[6]||(e[6]=l=>_.value=!1)},{default:n(()=>e[10]||(e[10]=[k("取消")])),_:1,__:[10]}),a(V,{type:"primary",onClick:j},{default:n(()=>e[11]||(e[11]=[k("保存")])),_:1,__:[11]})]),default:n(()=>[a(R,{model:r,"label-width":"120px"},{default:n(()=>[a(p,{label:"用户名"},{default:n(()=>[a(m,{modelValue:r.userName,"onUpdate:modelValue":e[3]||(e[3]=l=>r.userName=l)},null,8,["modelValue"])]),_:1}),a(p,{label:"昵称"},{default:n(()=>[a(m,{modelValue:r.nickname,"onUpdate:modelValue":e[4]||(e[4]=l=>r.nickname=l)},null,8,["modelValue"])]),_:1}),a(p,{label:"角色"},{default:n(()=>[a(C,{modelValue:r.roleId,"onUpdate:modelValue":e[5]||(e[5]=l=>r.roleId=l),placeholder:"请选择角色",clearable:"",multiple:""},{default:n(()=>[(f(!0),g(I,null,E(u.value,l=>(f(),U(w,{key:l.id,label:l.userRole,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const fe=se(re,[["__scopeId","data-v-0de498bd"]]);export{fe as default};
